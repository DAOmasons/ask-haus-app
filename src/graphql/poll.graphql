fragment PollCard on AskHausPoll {
  id
  title
  answerType
  description
  pollLink
  requestComment
  postedBy
  votesParams {
    id
    endTime
    startTime
    duration
  }
  pointsParams {
    checkpoint
    holderType
  }
  round_id
}

fragment BasicChoice on BasicChoice {
  id
  choiceId
  title
  description
  color
  link
}

fragment FullPoll on AskHausPoll {
  ...PollCard
  pointsAddress: pointsParams_id
  choicesParams {
    choices {
      ...BasicChoice
    }
  }
}

query getPoll($pollId: String!) {
  AskHausPoll_by_pk(id: $pollId) {
    ...FullPoll
  }
}

query frontPagePolls($now: numeric!) {
  upcomingPolls: AskHausPoll(
    where: { votesParams: { startTime: { _gt: $now } } }
    limit: 5
    order_by: { votesParams: { startTime: desc } }
  ) {
    ...PollCard
  }
  pastPolls: AskHausPoll(
    where: { votesParams: { endTime: { _lt: $now } } }
    limit: 5
    order_by: { votesParams: { startTime: desc } }
  ) {
    ...PollCard
  }
  activePolls: AskHausPoll(
    where: { votesParams: { startTime: { _lt: $now }, endTime: { _gt: $now } } }
    limit: 5
    order_by: { votesParams: { startTime: desc } }
  ) {
    ...PollCard
  }
}
